/* Reset Vite default styles để không phá style của app */
:root {
  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* FORCE: dùng đúng theme variables (SSOT) */
html, body, #root {
  height: 100% !important;
  width: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
  overflow: hidden !important;
}

html {
  overflow: hidden !important;
}

body {
  background: var(--bg, #f5f1ea) !important;
  color: var(--text, #1c1a17) !important;
  overflow: hidden !important;
  width: 100vw !important;
  height: 100vh !important;
  margin: 0 !important;
  padding: 0 !important;
}

#root {
  background: var(--bg, #f5f1ea) !important;
  height: 100vh !important;
  width: 100vw !important;
  margin: 0 !important;
  padding: 0 !important;
  overflow: hidden !important;
  position: relative !important;
}

/* WritingPane: Reset paragraph styles và căn baseline */
.writingPane .lp-editor {
  white-space: pre-wrap;
  word-break: break-word;
  /* Vietnamese diacritics support - đảm bảo dấu sắc kết hợp đúng */
  text-rendering: optimizeLegibility !important;
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
  font-feature-settings: normal !important;
  font-variant-ligatures: normal !important;
  /* Quan trọng: đảm bảo Unicode normalization và IME composition */
  unicode-bidi: normal !important;
  direction: ltr !important;
  /* Đảm bảo font hỗ trợ Vietnamese diacritics */
  font-family: "Times New Roman", Times, Georgia, ui-serif, serif !important;
  /* Đảm bảo text bắt đầu từ dòng đầu tiên - không có padding/margin */
  margin: 0 !important;
  padding: 0 !important;
  /* Căn text để baseline chạm dòng đầu tiên */
  display: block !important;
  /* Đảm bảo có thể click vào bất kỳ đâu để soạn thảo */
  cursor: text !important;
  /* Đảm bảo đủ chiều cao để click vào tất cả dòng */
  min-height: 888px !important; /* 37 lines * 24px */
  
  /* ===== INK SYSTEM v2 - "BÚT BI MẢNH" ===== */
  /* Font weight - Làm mảnh chữ tối đa */
  font-weight: 200 !important;
  
  /* Text fill gradient - CHỈ 2 STOP, RẤT NHẸ (gần như không nhìn thấy, chỉ "cảm") */
  background: linear-gradient(
    to bottom,
    var(--ink-gradient-top, #3A3530) 0%,
    var(--ink-gradient-bottom, #45403A) 100%
  );
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  color: transparent; /* Fallback */
  
  /* Edge handling - GIẢM CỰC MẠNH, chỉ 1 layer, không outer feather */
  /* Neutral band: để anti-alias mặc định xử lý, không can thiệp thêm */
  text-shadow: 0 0 0.5px var(--ink-edge-blend, rgba(106, 99, 90, 0.28));
  
  /* Font smoothing - Tối ưu để chữ mịn, nhưng để anti-alias tự nhiên */
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
  text-rendering: optimizeLegibility !important;
  /* KHÔNG dùng -webkit-text-stroke để tránh làm phình nét */
  
  /* Caret color - blink được browser tự xử lý */
  caret-color: var(--caret-ink, rgba(90, 75, 55, 0.65));
  
  /* Note: caret-width (1.5px) không được hỗ trợ rộng rãi, 
     browser sẽ dùng width mặc định (~1-2px tùy font-size) */
}

.writingPane .lp-editor p {
  margin: 0 !important;
  padding: 0 !important;
  line-height: 24px !important;
  /* Đảm bảo diacritics render đúng trong paragraphs */
  text-rendering: optimizeLegibility !important;
  font-family: "Times New Roman", Times, Georgia, ui-serif, serif !important;
  /* Font weight - Làm mảnh chữ tối đa */
  font-weight: 200 !important;
  /* Đảm bảo paragraph bắt đầu từ dòng đầu tiên - không có spacing */
  margin-top: 0 !important;
  margin-bottom: 0 !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
  /* Đảm bảo không có spacing giữa các dòng */
  display: block !important;
  /* Kế thừa ink gradient và edge blend từ parent */
  background: inherit;
  -webkit-background-clip: inherit;
  background-clip: inherit;
  -webkit-text-fill-color: inherit;
  color: inherit;
  text-shadow: inherit;
  /* Font smoothing */
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
  -webkit-text-stroke: inherit;
}

/* Đảm bảo paragraph đầu tiên không có margin-top */
.writingPane .lp-editor p:first-child {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

/* Đảm bảo tất cả text nodes trong editor render diacritics đúng */
.writingPane .lp-editor * {
  text-rendering: optimizeLegibility !important;
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
  /* Kế thừa ink gradient và edge blend */
  background: inherit;
  -webkit-background-clip: inherit;
  background-clip: inherit;
  -webkit-text-fill-color: inherit;
  color: inherit;
  text-shadow: inherit;
}

/* Quan trọng: Đảm bảo IME composition hoạt động đúng cho Vietnamese */
.writingPane .lp-editor[contenteditable="true"] {
  ime-mode: active !important;
  -webkit-ime-mode: active !important;
}

/* Đảm bảo text nodes không bị transform hoặc scale làm lệch diacritics */
.writingPane .lp-editor,
.writingPane .lp-editor * {
  transform: none !important;
  text-transform: none !important;
  letter-spacing: normal !important;
}

/* Line numbers - hover vùng gutter tăng opacity nhẹ */
.writingPane .pageBody:hover .lineNumber {
  opacity: 0.50 !important; /* Tăng từ 0.30 → 0.50 khi hover (không animation mạnh) */
}

.writingPane .pageBody .lineNumbers {
  opacity: 1; /* Container luôn visible, chỉ số bên trong nhạt */
}
